<!DOCTYPE html>
<html lang="en">
<head>
	<title>BetCalc</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

	<script>
	var dbg = false;
	var bets, betsSoFar=[], betsPlayed;
	
	function geturlparamvalue(name) {
		name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
		var regexS = "[\\?&]" + name + "=([^&#]*)";
		var regex = new RegExp(regexS);
		var results = regex.exec(window.location.href);
		if(results!=null){
			return results[1];
		}else{
			return -1;
		}
	}

	function removeBetId(betId){
		betsSoFar.splice(betId, 1);
		updateOddsTable();
	}

	function updateOddsTable(){
		var betType = $("#betTypeSelect option:selected").text();
		var betTypeOptions = $("#betTypeOptionsSelect option:selected").text();
		var betTypeOddsValue = parseFloat($("#betTypeOddsValue").val());
		var betTypeAmountValue = parseFloat($("#betTypeAmountValue").val());

		betsPlayed = []
		for(var i=0; i<betsSoFar.length; i++){
			betsPlayed.push(betsSoFar[i]);
		}
		betsPlayed.push([betType, betTypeOptions, betTypeOddsValue, betTypeAmountValue, "NotFixedYet"]);
		console.log("betsPlayed=",betsPlayed);
		
		var fMat=[];
		for(var i=0; i<=10; i++){
			fMat.push([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
		}

		var curType, curOption, curOdd, curAmount, curStatus, betTable='<tr><th>$$$</th><th>Odds</th><th>Option</th><th>Type</th><th>Status</th></tr>';
		for(var ind=0; ind<betsPlayed.length; ind++){
			curType = betsPlayed[ind][0];
			curOption = betsPlayed[ind][1];
			curOdd = betsPlayed[ind][2];
			curAmount = betsPlayed[ind][3];
			curStatus = betsPlayed[ind][4];
			console.log("Starting: ",curType,curOption,curOdd,curAmount);

			for(var i=0; i<=10; i++){
				for(var j=0; j<=10; j++){
					switch(curType+'#'+curOption){
						//1x2
						case '1x2#1':
							if(i>j){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i<=j){fMat[i][j]-= curAmount}
							break;	
						case '1x2#x':
							if(i==j){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i!=j){fMat[i][j]-= curAmount}
							break;
						case '1x2#2':
							if(i<j){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i>=j){fMat[i][j]-= curAmount}
							break;
						//doublechance
						case 'doublechance#1x':
							if(i>=j){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i<j){fMat[i][j]-= curAmount}
							break;
						case 'doublechance#12':
							if(i!=j){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i==j){fMat[i][j]-= curAmount}
							break;
						case 'doublechance#x2':
							if(i<=j){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i>j){fMat[i][j]-= curAmount}
							break;
						//drawnobet
						case 'drawnobet#1':
							if(i>j){fMat[i][j]+= (curOdd-1)*curAmount}
							// i==j, nothing
							if(i<j){fMat[i][j]-= curAmount}
							break;
						case 'drawnobet#2':
							if(i<j){fMat[i][j]+= (curOdd-1)*curAmount}
							// i==j, nothing
							if(i>j){fMat[i][j]-= curAmount}
							break;
						//oddeven_goals
						case 'oddeven_goals#odd':
							if((i+j)%2==1){fMat[i][j]+= (curOdd-1)*curAmount}
							if((i+j)%2==0){fMat[i][j]-= curAmount}
							break;
						case 'oddeven_goals#even':
							if((i+j)%2==0){fMat[i][j]+= (curOdd-1)*curAmount}
							if((i+j)%2==1){fMat[i][j]-= curAmount}
							break;
						//OU_goals
						case 'OU_goals#over05':
							if(i+j> 0.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j<=0.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#under05':
							if(i+j< 0.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j>=0.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#over15':
							if(i+j> 1.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j<=1.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#under15':
							if(i+j< 1.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j>=1.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#over25':
							if(i+j> 2.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j<=2.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#under25':
							if(i+j< 2.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j>=2.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#over35':
							if(i+j> 3.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j<=3.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#under35':
							if(i+j< 3.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j>=3.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#over45':
							if(i+j> 4.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j<=4.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#under45':
							if(i+j< 4.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j>=4.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#over55':
							if(i+j> 5.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j<=5.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#under55':
							if(i+j< 5.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j>=5.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#over65':
							if(i+j> 6.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j<=6.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#under65':
							if(i+j< 6.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j>=6.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#over75':
							if(i+j> 7.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j<=7.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#under75':
							if(i+j< 7.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j>=7.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#over85':
							if(i+j> 8.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j<=8.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#under85':
							if(i+j< 8.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j>=8.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#over95':
							if(i+j> 9.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j<=9.5){fMat[i][j]-= curAmount}
							break;
						case 'OU_goals#under95':
							if(i+j< 9.5){fMat[i][j]+= (curOdd-1)*curAmount}
							if(i+j>=9.5){fMat[i][j]-= curAmount}
							break;
					}
				}
			}
			
			console.log("Finished: ",curType,curOption,curOdd,curAmount);
			if(curStatus=="Fixed"){
				betTable +='<tr><td>'+curAmount+'</td><td>'+curOdd+'</td><td>'+curOption+'</td><td>'+curType+'</td><td>'+curStatus+'<input type="button" value="Remove" onclick="removeBetId('+ind+')"</td></tr>';
			}else{
				betTable +='<tr><td>'+curAmount+'</td><td>'+curOdd+'</td><td>'+curOption+'</td><td>'+curType+'</td><td>'+curStatus+'</td></tr>';
			}
		}

		$("#betTableSoFar").html(betTable);

		//console.log(fMat);
		for(var i=0; i<=10; i++){
			for(var j=0; j<=10; j++){
				$("#"+i+"x"+j).html(+fMat[i][j].toFixed(2));
				if(fMat[i][j]>0){ $("#"+i+"x"+j).css("background-color", "green"); }
				if(fMat[i][j]==0){ $("#"+i+"x"+j).css("background-color", "lightgrey"); }
				if(fMat[i][j]<0){ $("#"+i+"x"+j).css("background-color", "red"); }
			}
		}
	}

	$(document).ready(function(){
		$(".cellstyle").css("background-color","lightgrey");
		$(".tableborder").css("background-color","#F8B801");
		
		$.ajax({url: "./bets.txt", success: function(result){
			bets=JSON.parse(result)['bets'];
			//console.log(bets);
			for(var i=0; i<bets.length; i++){
				$('#betTypeSelect').append($('<option>', {
				    value: i,
				    text: bets[i][0]
				}));
			}
		}});

		$("#betTypeSelect").change(function(){
			$('#betTypeOptionsSelect').html('');
			var selectedIndex = $("#betTypeSelect").val();
			if(selectedIndex >= 0){
				//console.log(bets[selectedIndex]);	
				for(var i=0; i<bets[selectedIndex][1].length; i++){
					console.log(bets[selectedIndex][1][i]);
					$('#betTypeOptionsSelect').append($('<option>', {
						value: i,
						text: bets[selectedIndex][1][i]
					}));
				}
			}
			updateOddsTable();
		});

		$("#betTypeOptionsSelect").change(function(){
			updateOddsTable();
		});

		$("#addBet").click(function(){
			if($("#betTypeSelect option:selected").text()!="Select"){
				betsSoFar.push([
					$("#betTypeSelect option:selected").text(),
					$("#betTypeOptionsSelect option:selected").text(),
					parseFloat($("#betTypeOddsValue").val()),
					parseFloat($("#betTypeAmountValue").val()),
					"Fixed"
				]);	
				$("#betTypeSelect").val(-1);
				$("#betTypeOptionsSelect").html('');
				updateOddsTable();
			}
		});

	});

	</script>

	<style>
	body {
		margin-bottom: 60px;
	}
	.cellstyle {
	    float:center;
	    position: relative;
	    /*width: 30%;*/
	    padding: 3px; 
	    /*width: 3%;
	    height: 3%;*/
	    /*margin: 2px;*/
	}
	</style>
</head>
<body>

	<div class = "page-header">
		<h2 class="text-center">BetCalc</h2>
	</div>

	<div class="container">
		<ul class="nav nav-tabs" id="guide-tabs">
			<li class="active"><a data-toggle="tab" href="#home">Home</a></li>
			<li><a data-toggle="tab" href="#menu3">About</a></li>
		</ul>

		<div class="tab-content">
			<div id="home" class="tab-pane fade in active">
				<p></p>
				
				<div id="bettable" class="col-xs-8">
					<table border="3">
						<tr>
							<td class="tableborder cellstyle">A - B</td>
							<td class="tableborder cellstyle">X - 0</td>
							<td class="tableborder cellstyle">X - 1</td>
							<td class="tableborder cellstyle">X - 2</td>
							<td class="tableborder cellstyle">X - 3</td>
							<td class="tableborder cellstyle">X - 4</td>
							<td class="tableborder cellstyle">X - 5</td>
							<td class="tableborder cellstyle">X - 6</td>
							<td class="tableborder cellstyle">X - 7</td>
							<td class="tableborder cellstyle">X - 8</td>
							<td class="tableborder cellstyle">X - 9</td>
							<td class="tableborder cellstyle">X - 10</td>
						</tr>
						<tr>
							<td class="cellstyle tableborder">0 - X</td>
							<td class="cellstyle">0 - 0<div id="0x0">0</div></td>
							<td class="cellstyle">0 - 1<div id="0x1">0</div></td>
							<td class="cellstyle">0 - 2<div id="0x2">0</div></td>
							<td class="cellstyle">0 - 3<div id="0x3">0</div></td>
							<td class="cellstyle">0 - 4<div id="0x4">0</div></td>
							<td class="cellstyle">0 - 5<div id="0x5">0</div></td>
							<td class="cellstyle">0 - 6<div id="0x6">0</div></td>
							<td class="cellstyle">0 - 7<div id="0x7">0</div></td>
							<td class="cellstyle">0 - 8<div id="0x8">0</div></td>
							<td class="cellstyle">0 - 9<div id="0x9">0</div></td>
							<td class="cellstyle">0 - 10<div id="0x10">0</div></td>
						</tr>
						<tr>
							<td class="cellstyle tableborder">1 - X</td>
							<td class="cellstyle">1 - 0<div id="1x0">0</div></td>
							<td class="cellstyle">1 - 1<div id="1x1">0</div></td>
							<td class="cellstyle">1 - 2<div id="1x2">0</div></td>
							<td class="cellstyle">1 - 3<div id="1x3">0</div></td>
							<td class="cellstyle">1 - 4<div id="1x4">0</div></td>
							<td class="cellstyle">1 - 5<div id="1x5">0</div></td>
							<td class="cellstyle">1 - 6<div id="1x6">0</div></td>
							<td class="cellstyle">1 - 7<div id="1x7">0</div></td>
							<td class="cellstyle">1 - 8<div id="1x8">0</div></td>
							<td class="cellstyle">1 - 9<div id="1x9">0</div></td>
							<td class="cellstyle">1 - 10<div id="1x10">0</div></td>
						</tr>
						<tr>
							<td class="cellstyle tableborder">2 - X</td>
							<td class="cellstyle">2 - 0<div id="2x0">0</div></td>
							<td class="cellstyle">2 - 1<div id="2x1">0</div></td>
							<td class="cellstyle">2 - 2<div id="2x2">0</div></td>
							<td class="cellstyle">2 - 3<div id="2x3">0</div></td>
							<td class="cellstyle">2 - 4<div id="2x4">0</div></td>
							<td class="cellstyle">2 - 5<div id="2x5">0</div></td>
							<td class="cellstyle">2 - 6<div id="2x6">0</div></td>
							<td class="cellstyle">2 - 7<div id="2x7">0</div></td>
							<td class="cellstyle">2 - 8<div id="2x8">0</div></td>
							<td class="cellstyle">2 - 9<div id="2x9">0</div></td>
							<td class="cellstyle">2 - 10<div id="2x10">0</div></td>
						</tr>
						<tr>
							<td class="cellstyle tableborder">3 - X</td>
							<td class="cellstyle">3 - 0<div id="3x0">0</div></td>
							<td class="cellstyle">3 - 1<div id="3x1">0</div></td>
							<td class="cellstyle">3 - 2<div id="3x2">0</div></td>
							<td class="cellstyle">3 - 3<div id="3x3">0</div></td>
							<td class="cellstyle">3 - 4<div id="3x4">0</div></td>
							<td class="cellstyle">3 - 5<div id="3x5">0</div></td>
							<td class="cellstyle">3 - 6<div id="3x6">0</div></td>
							<td class="cellstyle">3 - 7<div id="3x7">0</div></td>
							<td class="cellstyle">3 - 8<div id="3x8">0</div></td>
							<td class="cellstyle">3 - 9<div id="3x9">0</div></td>
							<td class="cellstyle">3 - 10<div id="3x10">0</div></td>
						</tr>
						<tr>
							<td class="cellstyle tableborder">4 - X</td>
							<td class="cellstyle">4 - 0<div id="4x0">0</div></td>
							<td class="cellstyle">4 - 1<div id="4x1">0</div></td>
							<td class="cellstyle">4 - 2<div id="4x2">0</div></td>
							<td class="cellstyle">4 - 3<div id="4x3">0</div></td>
							<td class="cellstyle">4 - 4<div id="4x4">0</div></td>
							<td class="cellstyle">4 - 5<div id="4x5">0</div></td>
							<td class="cellstyle">4 - 6<div id="4x6">0</div></td>
							<td class="cellstyle">4 - 7<div id="4x7">0</div></td>
							<td class="cellstyle">4 - 8<div id="4x8">0</div></td>
							<td class="cellstyle">4 - 9<div id="4x9">0</div></td>
							<td class="cellstyle">4 - 10<div id="4x10">0</div></td>
						</tr>
						<tr>
							<td class="cellstyle tableborder">5 - X</td>
							<td class="cellstyle">5 - 0<div id="5x0">0</div></td>
							<td class="cellstyle">5 - 1<div id="5x1">0</div></td>
							<td class="cellstyle">5 - 2<div id="5x2">0</div></td>
							<td class="cellstyle">5 - 3<div id="5x3">0</div></td>
							<td class="cellstyle">5 - 4<div id="5x4">0</div></td>
							<td class="cellstyle">5 - 5<div id="5x5">0</div></td>
							<td class="cellstyle">5 - 6<div id="5x6">0</div></td>
							<td class="cellstyle">5 - 7<div id="5x7">0</div></td>
							<td class="cellstyle">5 - 8<div id="5x8">0</div></td>
							<td class="cellstyle">5 - 9<div id="5x9">0</div></td>
							<td class="cellstyle">5 - 10<div id="5x10">0</div></td>
						</tr>
						<tr>
							<td class="cellstyle tableborder">6 - X</td>
							<td class="cellstyle">6 - 0<div id="6x0">0</div></td>
							<td class="cellstyle">6 - 1<div id="6x1">0</div></td>
							<td class="cellstyle">6 - 2<div id="6x2">0</div></td>
							<td class="cellstyle">6 - 3<div id="6x3">0</div></td>
							<td class="cellstyle">6 - 4<div id="6x4">0</div></td>
							<td class="cellstyle">6 - 5<div id="6x5">0</div></td>
							<td class="cellstyle">6 - 6<div id="6x6">0</div></td>
							<td class="cellstyle">6 - 7<div id="6x7">0</div></td>
							<td class="cellstyle">6 - 8<div id="6x8">0</div></td>
							<td class="cellstyle">6 - 9<div id="6x9">0</div></td>
							<td class="cellstyle">6 - 10<div id="6x10">0</div></td>
						</tr>
						<tr>
							<td class="cellstyle tableborder">7 - X</td>
							<td class="cellstyle">7 - 0<div id="7x0">0</div></td>
							<td class="cellstyle">7 - 1<div id="7x1">0</div></td>
							<td class="cellstyle">7 - 2<div id="7x2">0</div></td>
							<td class="cellstyle">7 - 3<div id="7x3">0</div></td>
							<td class="cellstyle">7 - 4<div id="7x4">0</div></td>
							<td class="cellstyle">7 - 5<div id="7x5">0</div></td>
							<td class="cellstyle">7 - 6<div id="7x6">0</div></td>
							<td class="cellstyle">7 - 7<div id="7x7">0</div></td>
							<td class="cellstyle">7 - 8<div id="7x8">0</div></td>
							<td class="cellstyle">7 - 9<div id="7x9">0</div></td>
							<td class="cellstyle">7 - 10<div id="7x10">0</div></td>
						</tr>
						<tr>
							<td class="cellstyle tableborder">8 - X</td>
							<td class="cellstyle">8 - 0<div id="8x0">0</div></td>
							<td class="cellstyle">8 - 1<div id="8x1">0</div></td>
							<td class="cellstyle">8 - 2<div id="8x2">0</div></td>
							<td class="cellstyle">8 - 3<div id="8x3">0</div></td>
							<td class="cellstyle">8 - 4<div id="8x4">0</div></td>
							<td class="cellstyle">8 - 5<div id="8x5">0</div></td>
							<td class="cellstyle">8 - 6<div id="8x6">0</div></td>
							<td class="cellstyle">8 - 7<div id="8x7">0</div></td>
							<td class="cellstyle">8 - 8<div id="8x8">0</div></td>
							<td class="cellstyle">8 - 9<div id="8x9">0</div></td>
							<td class="cellstyle">8 - 10<div id="8x10">0</div></td>
						</tr>
						<tr>
							<td class="cellstyle tableborder">9 - X</td>
							<td class="cellstyle">9 - 0<div id="9x0">0</div></td>
							<td class="cellstyle">9 - 1<div id="9x1">0</div></td>
							<td class="cellstyle">9 - 2<div id="9x2">0</div></td>
							<td class="cellstyle">9 - 3<div id="9x3">0</div></td>
							<td class="cellstyle">9 - 4<div id="9x4">0</div></td>
							<td class="cellstyle">9 - 5<div id="9x5">0</div></td>
							<td class="cellstyle">9 - 6<div id="9x6">0</div></td>
							<td class="cellstyle">9 - 7<div id="9x7">0</div></td>
							<td class="cellstyle">9 - 8<div id="9x8">0</div></td>
							<td class="cellstyle">9 - 9<div id="9x9">0</div></td>
							<td class="cellstyle">9 - 10<div id="9x10">0</div></td>
						</tr>
						<tr>
							<td class="cellstyle tableborder">10 - X</td>
							<td class="cellstyle">10 - 0<div id="10x0">0</div></td>
							<td class="cellstyle">10 - 1<div id="10x1">0</div></td>
							<td class="cellstyle">10 - 2<div id="10x2">0</div></td>
							<td class="cellstyle">10 - 3<div id="10x3">0</div></td>
							<td class="cellstyle">10 - 4<div id="10x4">0</div></td>
							<td class="cellstyle">10 - 5<div id="10x5">0</div></td>
							<td class="cellstyle">10 - 6<div id="10x6">0</div></td>
							<td class="cellstyle">10 - 7<div id="10x7">0</div></td>
							<td class="cellstyle">10 - 8<div id="10x8">0</div></td>
							<td class="cellstyle">10 - 9<div id="10x9">0</div></td>
							<td class="cellstyle">10 - 10<div id="10x10">0</div></td>
						</tr>
					</table>
				</div>
				<div id="bets" class="col-xs-4">
					<table border="3">
						<tr>
							<td id="betType" class="col-xs-12">BetType:</td>
							<td> 
								<select id="betTypeSelect">
									<option value="-1">Select</option>
								</select>
							</td>
						</tr>
						<tr>
							<td id="betTypeOptions" class="col-xs-12">BetOptions:</td>
							<td><select id="betTypeOptionsSelect"></select></td>
						</tr>
						<tr>
							<td id="betTypeOdds" class="col-xs-12">BetOdds:</td>
							<td><input type="number" id="betTypeOddsValue" value="2" onkeyup="updateOddsTable();"></td>
						</tr>
						<tr>
							<td id="betTypeAmount" class="col-xs-12">BetAmount:</td>
							<td><input type="number" id="betTypeAmountValue" value="1" onkeyup="updateOddsTable();"></td>
						</tr>
						<tr>
							<td colspan="2" id="placeBetButton" class="col-xs-12">
								<input type="button" id="addBet" value="PlaceBet!">
							</td>
						</tr>
					</table>

					<p></p>
					<p>BetsPlayedSoFar:</p>
					<table border="3" id="betTableSoFar">
						<tr>	
							<td>Bets So Far:</td>
							<td>NA</td>
							<td>NA</td>
							<td>NA</td>
						</tr>
					</table>

				</div>
			</div>

			<div id="menu3" class="tab-pane fade">
				<p>
					<dl class="dl-horizontal">
						<dt>BetCalc:</dt>
						<dd>is self explanatory.</dd>
						<dt>Github Page:</dt>
						<dd><a href="http://rallis.github.io/betcalc/" target="_blank">http://rallis.github.io/betcalc/</a></dd>
						<dt>Github Code:</dt>
						<dd><a href="http://github.com/rallis/betcalc/" target="_blank">http://github.com/rallis/betcalc/</a></dd>
					</dl>
				</p>	

			</div>
		</div>	
	</div>

</body>
</html>

